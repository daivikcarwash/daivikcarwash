<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daivik Doorstep Car Wash | Haridwar</title>

<style>
/* BASIC CSS SHORT FOR HERE — YOUR ORIGINAL CSS WORKS */
/* REVIEW BOX */
.review-box{
  background:#eef5ff;
  padding:15px;
  border-left:5px solid #004c97;
  border-radius:10px;
  margin-top:15px;
  position:relative;
}
.delete-btn{
  position:absolute;
  top:10px;
  right:10px;
  background:#ff3b3b;
  color:white;
  border:none;
  padding:5px 10px;
  border-radius:6px;
  cursor:pointer;
}
.star{
  color:#ff9800;
  font-size:20px;
}
</style>
</head>
<body>

<section id="reviews" class="box">
  <h2>Customer Reviews</h2>

  <div>
    <h3 style="text-align:center;">Give Your Review</h3><br>

    <input id="name" type="text" placeholder="Your Name"
      style="width:100%; padding:10px; margin-bottom:10px;">

    <!-- STAR RATING -->
    <div id="rating" style="font-size:26px; text-align:center; margin-bottom:10px; cursor:pointer;">
      ★★★★★
    </div>

    <textarea id="review" rows="4" placeholder="Write your review..."
      style="width:100%; padding:10px;"></textarea>

    <button onclick="addReview()" class="btn">Submit Review</button>
  </div>

  <h3 style="margin-top:30px;">All Reviews</h3>
  <div id="reviewList"></div>
</section>

<script>
let selectedRating = 5;
const API_URL = "PASTE_YOUR_GOOGLE_SCRIPT_DEPLOY_URL_HERE";

// ⭐ STAR RATING SELECTOR
document.getElementById("rating").addEventListener("click", function(e){
  if(e.target.innerText === "★"){
    selectedRating = [...this.innerText].indexOf("★", [...this.innerText].indexOf(e.target.innerText)) + 1;
    this.innerHTML = "★★★★★".slice(0, selectedRating) + "☆☆☆☆☆".slice(0, 5 - selectedRating);
  }
});

// ⭐ LOAD REVIEWS FROM GOOGLE SHEET
async function loadReviews(){
  const res = await fetch(API_URL);
  const data = await res.json();

  document.getElementById("reviewList").innerHTML = "";

  data.reverse().forEach(r => {
    addReviewToDOM(r.id, r.name, r.rating, r.review);
  });
}

// ⭐ ADD REVIEW FUNCTION (POST to Google Sheet)
async function addReview(){
  let name = document.getElementById("name").value;
  let review = document.getElementById("review").value;

  if(name.trim()=="" || review.trim()==""){
    alert("Please fill all fields!");
    return;
  }

  await fetch(API_URL, {
    method:"POST",
    body:JSON.stringify({
      name:name,
      rating:selectedRating,
      review:review
    })
  });

  document.getElementById("name").value = "";
  document.getElementById("review").value = "";
  selectedRating = 5;
  document.getElementById("rating").innerHTML = "★★★★★";

  loadReviews();
}

// ⭐ Add Review to Page
function addReviewToDOM(id, name, rating, review){
  let container = document.createElement("div");
  container.className = "review-box";

  container.innerHTML = `
    <b>${name}</b><br>
    <span class="star">${"★".repeat(rating)}${"☆".repeat(5-rating)}</span><br>
    ${review}
    <button class="delete-btn" onclick="deleteReview(${id})">Delete</button>
  `;

  document.getElementById("reviewList").prepend(container);
}

// ⭐ DELETE REVIEW
async function deleteReview(id){
  await fetch(API_URL + "?delete=" + id);
  loadReviews();
}

loadReviews();
</script>

</body>
</html>